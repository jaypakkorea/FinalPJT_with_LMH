import {
  generateComponentFromPath,
  isIconPath,
  normalizeIconPath
} from "./chunk-7T2N3LCA.mjs";
import {
  __require
} from "./chunk-2CNQOCG6.mjs";

// src/index.ts
import { createUnplugin } from "unplugin";

// src/core/options.ts
import hasPkg from "has-pkg";
function resolveOptions(options) {
  const {
    scale = 1.2,
    defaultStyle = "",
    defaultClass = "",
    compiler = guessCompiler(),
    jsx = guessJSX()
  } = options;
  return {
    scale,
    defaultStyle,
    defaultClass,
    compiler,
    jsx
  };
}
function guessCompiler() {
  return getVueVersion() || (hasPkg("@svgr/core") ? "jsx" : "vue3");
}
function guessJSX() {
  if (hasPkg("preact"))
    return "preact";
  return "react";
}
function getVueVersion() {
  var _a;
  try {
    const vue = __require("vue");
    const version = ((_a = vue == null ? void 0 : vue.default) == null ? void 0 : _a.version) || (vue == null ? void 0 : vue.version) || "3";
    return version.startsWith("2.") ? "vue2" : "vue3";
  } catch {
    return null;
  }
}

// src/index.ts
var unplugin = createUnplugin((options = {}) => {
  const resolved = resolveOptions(options);
  return {
    name: "unplugin-icons",
    resolveId(id) {
      if (isIconPath(id)) {
        const res = normalizeIconPath(id).replace(/\.\w+$/i, "").replace(/^\//, "");
        const ext = options.compiler === "jsx" ? ".jsx" : "";
        return res + ext;
      }
      return null;
    },
    async load(id) {
      if (isIconPath(id))
        return await generateComponentFromPath(id, resolved) || null;
      return null;
    }
  };
});
var src_default = unplugin;

export {
  src_default
};
